% -*- TeX -*- -*- UK -*- -*- Soft -*-

\chapter{Introduction}
\label{chap:Introduction}

\section{Overview}
\label{sec:introductionOverview}

\libradtran{} \cite{EmdeLibRadtran2016,libRadtran2005} is a free C- and Fortran-based collection of programs and libraries for the calculation of radiative transfer and solar and thermal radiation in the earth's atmosphere.
The concept of a network-based \libradtran{} server allows the  distributed deployment of the \libradtran{} functionality. The server approach allows easy access for any number of users\footnote{\libradtran{} is easiest to build on Linux and, when deployed on a Linux server, provide easy access to Windows users.} and also supports deployment on clusters with many computational nodes.

Dask \cite{daskhomepage2020} is a library for parallel computing in Python that works on a local computer, a remote computer and cluster computers.
Dask has two parts: (1) dynamic task scheduling for executing, and (2) fast processing of Python data structures (e.g., numpy, pandas, etc.).  The main interest in Dask for this application is for distributed  processing, with less interest in fast processing of Python structures. Using Dask requires only Python familiarity and can deploy tasks to large clusters with thousands of cores.

The \libraddask{}  is a Python module that integrates \libradtran{} with Dask with the aim to provide a remote and network-distributed \libradtran{}. This functionality is only available via Python, but this is not considered a major issue with most of the work flow is in Python.

For rapid shortwave spectrum work, the band parametrisation by Kato is typically used.
The Kato model has only 32 spectral bands across the whole available spectrum and all computations
are reduced to a vector of values representative of the Kato bands.

For more accurate work, such as simulations of satellite views of water targets, the REPTRAN
model is preferred. REPTRAN provides a full spectral calculation or rapid band model calculations
for a variety of satellite sensors.

libRadtran is able to calculate radiances and irradiances when the sun is below the horizon by up
to 9 degrees or more. This is well into "nautical" twilight. The MYSTIC monte carlo solver is
required to perform twilight computations.


\section{Historical Background}
The \libraddask{} library was originally written by Derek Griffith \cite{DerekJGriffithMORTICIA} as part of a larger project.  The files pertaining to using Dask for distributed \libradtran{} were extracted as a stand-alone project.  The work was originally done in Python 2 against the \libradtran{} 2.0.0 Python files.

This version ported all the code to Python 3 and uses the  the \libradtran{} 2.0.3 Python files.
No new substantial functionality is added.
This present document was added by its author as a means to document the new project.

\section{Example Case Study}

For the practical example in this document, assume the following (will be different in your installation):
\begin{enumerate}
\item The Dask client will be activated in code run on a local computer using Windows.  The Dask scheduler and workers will be running on a remote server using Linux.
\item Server (Linux):
\begin{enumerate}
\item The server is called \lstinline{nimbus} with IP address \lstinline{146.64.246.94}
\item The work is done from  user account \lstinline{dgriffith} on the server.
\item The Python and dask packages are set up in the \lstinline{mordevpy37} conda environment  on the server.
\end{enumerate}

\item Local PC (Windows):
\begin{enumerate}
\item The Python and dask packages are set up in the \lstinline{mort} conda environment  on the local computer.
\end{enumerate}

\end{enumerate}


\section{Document Structure}
\label{sec:DocumentStructure}

Chapter~\ref{chap:Dask} provides an overview of Dask, on a conceptual and practical basis.  Understanding of these concepts are important for effectively using the server.

Chapter~\ref{chap:libRadtran}  provides and overview of \libradtran{}, including obtaining, installation and simple example usage.

Chapter~\ref{chap:libraddaskSetup}  provides instructions on how to set up \libraddask{}.

Chapter~\ref{chap:ServerUserManual}  contains and extract of an example Jupyter notebook on how to use  \libraddask{}.

Chapter~\ref{chap:Conclusion} concludes the document.

Appendix~\ref{chap:SimpleDaskExamples} contains additional Dask examples.

Appendix~\ref{chap:Portingscr_pytoPython3}  contains a description of the porting of the \libradtran{} Python files in \lstinline{scr_py} to Python 3.

Appendix~\ref{chap:Tools}  contains additional information on tools that may be useful when using \libraddask{}.
 